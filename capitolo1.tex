\chapter{Introduzione}
\label{Introduction}
\thispagestyle{empty}

\noindent This work lays at the intersection of observational solar physics and cutting-edge computer science. The activity of the Sun can be studied by observing the phenomena that take place on its surface, like sunspots. The purpose of this thesis is to detect and count sunspots using modern computer vision techniques, while also intending to completely remove human intervention in the process.
\bigbreak
\noindent Traditionally, scientists identified solar features manually, sometimes with the aid of simple image processing algorithms. Recently, deep learning demostrated that computers can achieve human performance in many challenging tasks. In spite of this, the scientific community seems reluctant in the adoption of new technology that eliminates the need for expert supervision. Nevertheless, during the last years, some encouraging signs of change in this trend were sent by the most important organizations of the field of science.
\bigbreak
\noindent The European Organization for Nuclear Research (CERN) started applying deep neural networks to high energy physics simulations \cite{de2017learning}. In astrophysics, the National Aeronautics and Space Administration (NASA) published an article in which machine learning is used for exoplanet detection \cite{shallue2018identifying}. In solar physics, the production of research studies using deep learning was stimulated by the publication of ready-to-use datasets \cite{McGregor2017} of the activity of the Sun. These attempts are very promising, but a real revolution in the field seems decades away. In this context, the work presented in this thesis wants to be a driving force for the modernization of the techniques that are used for scientific research.
\bigbreak
\noindent The idea of creating a program that infers the activity of the Sun by counting sunspots on the disk came to my mind during the time spent at the European Space Agency as an intern. For one year I worked at the Helios solar observatory, located in Madrid, Spain, where I learned all the basics of solar observation. My tasks ranged from practical telescope operation to the processing of the acquired images. In the process of developing the necessary tools for the automation of the whole daily observation routine, I also started to be interested in the physics that lays underneath the visible features of the Sun. The more I researched, the more I realized that there were great opportunities for machine learning to be applied to solar physics. Also, the abundance of data that modern instrumentations provide really encouraged me to experiment various solutions to the challenges that the study of the Sun proposes. The most successful of these experiments led to the realization of this thesis. The other part of the work that I did, but does not strictly relate to sunspot detection is left for the reader in appendix.
\bigbreak
\noindent To be more precise about the meaning of ``sunspot counting'', it is first necessary to understand the concept of sunspot. The Sun, the closest star to the Earth, is a sphere composed by hot ionized plasma that moves by convection, generating a strong magnetic field. One of the properties of magnetic field is that it tends to agglomerate into tubes that run accross the volume of the sun and sometimes intersect with the surface. When this happens the outer layers of the star get perturbated and the convective mechanism that propagates the heat outwards gets locally interrupted, reducing the temperature of the interested area. The regions of reduced surface temperature caused by high concentrations of magnetic fields are called sunspots. Sunspots can be seen as manifestations of the internal dynamics of the Sun, therefore we expect high correlation with other similar phenomena.
\bigbreak
\noindent During the last century, a series of studies proved several connections between the presence of sunspots and other indicators that can be detected from the Earth. Sunspots turned out to be strongly correlated with the repercussions of solar activity on the environment of the Earth. These interesting properties, together with the fact that they are observable with relatively cheap instrumentation, made the study of sunspots one of the most important aspects of solar physics.
\bigbreak
\noindent In the early XVII century, solar observation pioneers started looking up at the Sun and counting the number of sunspots they could see. During more than 400 years, humanity kept recording and comparing the data using the relative sunspot number formula, ideated by R. Wolf in 1848, a simple expression that uses both the number of single spots and the concept of sunspot groups to obtain a unique time series. Nowadays, sunspot counting is still done by humans, apart from some limited automatic solutions that work on specififc datasets. The scientific community seems not to be intentioned to change the counting methodology in favor of automatic programs because that would generate a discontinuity in the annotation criteria. This thesis aims to show that modern computer vision models can learn the counting criteria from human experts, to be able to later produce an estimate of the number of sunspots that aligns with human results.
\bigbreak
\noindent The algorithm proposed in this thesis uses only white-light images of the Sun for its computations and it is composed by two main components: the semantic segmentation component, that detects the areas of the image where sunspots are present, and the sunspot clustering component that uses representation learning techniques in combination with clustering in order to identify the number of groups. Both components use deep neural networks for their computations. The sunspot number time series produced by our algorithm is then compared with the international sunspot number (ISN) produced by SIDC-SILSO. The results show that, the algorithm is able to capture the trend of the solar activity pretty nicely, making it a good tool for its estimation.
\bigbreak
\noindent A more detailed view of all the aspects of solar physics that are relevant for the unterstanding of this thesis is given in \autoref{capitolo2}, together with a review of the history of solar observation.
\bigbreak
\noindent \autoref{capitolo3} contains a description of the most important automatic programs for the annotation of images of the Sun. Avantages and disadvantages of each one are highlighted and the aspects of the solution presented in this thesis that represent an improvement are outlined.
\bigbreak
\noindent \autoref{capitolo4} is divided in four sections. The first one gives the reader an introduction to the basics of machine learning, with particular focus on neural networks and how they learn. The following three sections review the most popular algorithms that perform respectively semantic segmentation, clustering and representation learning. The purpose of these sections is also to give the reader a gentle introduction on deep learning, making the rest of the thesis clearer.
\bigbreak
\noindent \autoref{capitolo5} shows the formal setting of the problem we want to tackle and also provides visual intuition of the type of annotations that need to be performed from the algorithm.
\bigbreak
\noindent \autoref{capitolo6} gives a detailed description of the data. The chapter describes how four datasets have been merged together to create a single, more comprehensive one to run the experiments. The challenges of the whole data preparation process are highlighted, and the splitting of data in train, validation and test set are touched on.
\bigbreak
\noindent \autoref{capitolo7} is the core of the work. It contais an exhaustive explanation of the process of training both components of the algorithm. The procedure for predicting the sunspot number on unseen data is explained in the second section of this chapter, while the last section takes care the estimation of those parameters that are necessary for the algorithm to work and be compared with others.
\bigbreak
\noindent \autoref{capitolo8} explains the reasons underlying the tests that have been carried out, the quantitative final results and how they can be refined in the future.
\bigbreak
\noindent The first two appendices (A, B) serve as an aid to the reder respectively to navigate through the terminology of solar physics more rapidly and get a more visual intuition of the various forms the sunspots can take.
\bigbreak
\noindent The last two appendices (C, D) explain some interesting parts of the work done at the European Space Agency, that are not completely on focus with the thesis but are still a valid tool to better understand the field of solar observation. In particular Appendix C explains the main processing techniques that have been used to enhance some features of the Sun, while Appendix D talks about how the automation of the Helios observatory was achieved during my internship.
